
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>11. More Monte Carlo: The Metropolis Algorithm &#8212; An Introduction to Scientific Computing (with Particle Physics Phenomenology)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapters/Chapter11/Chapter11';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="12. A Brief Introduction to Monte Carlo Event Generators in Particle Physics" href="../Chapter13/Chapter13.html" />
    <link rel="prev" title="10. Partial Differential Equations" href="../Chapter10/Chapter10.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/d2lbanner2.png" class="logo__image only-light" alt="An Introduction to Scientific Computing (with Particle Physics Phenomenology) - Home"/>
    <script>document.write(`<img src="../../_static/d2lbanner2.png" class="logo__image only-dark" alt="An Introduction to Scientific Computing (with Particle Physics Phenomenology) - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    An Introduction to Scientific Computing (with Particle Physics Phenomenology)
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Chapter1/Chapter1.html">1. Making Computers Obey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter2/Chapter2.html">2. Computer Number Representations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter3/Chapter3.html">3. Randomness and Random Walks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter4/Chapter4.html">4. Numerical Differentiation and Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter5/Chapter5.html">5. Monte Carlo Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter6/Chapter6.html">6. Matrix Computing, Trial-and-Error Searching and Data Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter7/Chapter7.html">7. Ordinary Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter8/Chapter8.html">8. An Introduction to Nonlinear Dynamics and Chaos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter9/Chapter9.html">9. Boundary Value and Eigenvalue Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter10/Chapter10.html">10. Partial Differential Equations</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">11. More Monte Carlo: The Metropolis Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter13/Chapter13.html">12. A Brief Introduction to Monte Carlo Event Generators in Particle Physics</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FChapters/Chapter11/Chapter11.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Chapters/Chapter11/Chapter11.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>More Monte Carlo: The Metropolis Algorithm</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-algorithm-of-metropolis-et-al">11.1. The Algorithm of Metropolis et al.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proof-of-the-metropolis-et-al-algorithm">11.2. Proof of the Metropolis et al. Algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-the-metropolis-et-al-algorithm">11.3. Applying the Metropolis et al. Algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-11-1-the-metropolis-algorithm-for-one-dimensional-integration">11.4. Example 11.1: The Metropolis Algorithm for One-dimensional Integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-monte-carlo">11.5. Quantum Monte Carlo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model">11.5.1. The Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variational-monte-carlo">11.5.2. Variational Monte Carlo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-11-2-variational-monte-carlo-for-the-hydrogen-atom">11.5.3. Example 11.2 Variational Monte Carlo for the Hydrogen Atom</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vmc-for-the-h-2-molecule-and-he-atom">11.5.4. VMC for the H_2 Molecule and He Atom</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-11-3-variational-monte-carlo-for-the-helium-atom">11.5.5. Example 11.3 Variational Monte Carlo for the Helium Atom</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-11-4-variational-monte-carlo-for-the-hydrogen-molecule">11.5.6. Example 11.4: Variational Monte Carlo for the Hydrogen Molecule</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="more-monte-carlo-the-metropolis-algorithm">
<h1><span class="section-number">11. </span>More Monte Carlo: The Metropolis Algorithm<a class="headerlink" href="#more-monte-carlo-the-metropolis-algorithm" title="Link to this heading">#</a></h1>
<section id="the-algorithm-of-metropolis-et-al">
<h2><span class="section-number">11.1. </span>The Algorithm of Metropolis et al.<a class="headerlink" href="#the-algorithm-of-metropolis-et-al" title="Link to this heading">#</a></h2>
<p>We have already discussed algorithms for generating random numbers according to a specified distribution (e.g. via von Neumann rejection).</p>
<p>However, it is difficult, or impossible, to generalize them to sample a complicated weight function in many dimensions, and so an alternate approach is required.</p>
<p>A very general way to produce random variables with a given probability distribution of arbitrary form is the algorithm of Metropolis, Rosenbluth, Rosenbluth, Teller and Teller (<a class="reference external" href="https://doi.org/10.1063/1.1699114">https://doi.org/10.1063/1.1699114</a>).</p>
<p>This algorithm requires only the ability to calculate the weight function for a given value of the integration variable.</p>
<p>It proceeds as follows: Suppose we want to generate a set of points in a possibly multi-dimensional space of variables, <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>, distributed with probability density <span class="math notranslate nohighlight">\(w(\mathbf{X})\)</span>.</p>
<p>The Metropolis et al. algorithm generates a sequence of points:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{X}_0, \mathbf{X}_1, ...\)</span>,</p>
<p>as those visited successively by a random walker moving through <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> space.</p>
<p>As the walk gets longer and longer, the points it connects approximate more closely the desired distribution.</p>
<p>The rules of the random walk through configuration space are as follows:</p>
<ul class="simple">
<li><p>Suppose a random walker is at point <span class="math notranslate nohighlight">\(\mathbf{X}_n\)</span> in the sequence.</p></li>
<li><p>To generate <span class="math notranslate nohighlight">\(\mathbf{X}_{n+1}\)</span>, it makes a <em>trial step</em> to a new point, <span class="math notranslate nohighlight">\(\mathbf{X}_t\)</span>.</p></li>
<li><p>This new point can be chosen in any convenient manner, e.g. uniformly at random within a multi-dimensional cube of small size <span class="math notranslate nohighlight">\(\delta\)</span> about <span class="math notranslate nohighlight">\(\mathbf{X}_n\)</span>.</p></li>
<li><p>The trial step is then “accepted” or “rejected” according to the ratio:</p></li>
</ul>
<p><span class="math notranslate nohighlight">\( r = \frac{ w(\mathbf{X}_t) } { w(\mathbf{X}_n) }\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(r&gt;1\)</span> then the step is accepted and we set <span class="math notranslate nohighlight">\(\mathbf{X}_{n+1} = \mathbf{X}_t\)</span>, while if <span class="math notranslate nohighlight">\(r&lt;1\)</span>, the step is accepted with probability <span class="math notranslate nohighlight">\(r\)</span>.</p>
<p>This is accomplished by comparing <span class="math notranslate nohighlight">\(r\)</span> with a random number <span class="math notranslate nohighlight">\(\eta\)</span>, uniformly distributed in <span class="math notranslate nohighlight">\([0,1]\)</span>, and accepting the step if <span class="math notranslate nohighlight">\(\eta &lt; r\)</span>.</p>
<p>If the trial step is not accepted, then it is rejected and we put <span class="math notranslate nohighlight">\(\mathbf{X}_{n+1} = \mathbf{X}_n\)</span>.</p>
<ul class="simple">
<li><p>This generates <span class="math notranslate nohighlight">\(\mathbf{X}_{n+1}\)</span>, and we may then proceed to generate <span class="math notranslate nohighlight">\(\mathbf{X}_{n+2}\)</span> by the same process, making a trial step from <span class="math notranslate nohighlight">\(\mathbf{X}_{n+1}\)</span>.</p></li>
<li><p>Any arbitrary point <span class="math notranslate nohighlight">\(\mathbf{X}_0\)</span> can be chosen as the starting point for the random walk.</p></li>
<li><p>During this process, the code could be made more efficient by saving the weight function at the current point of the random walk, so that it need not be computed again when deciding whether or not to accept the trial step. The evaluation of <span class="math notranslate nohighlight">\(w\)</span> is often the most time-consuming part of a Monte Carlo calculation using the Metropolis et al. algorithm.</p></li>
</ul>
</section>
<section id="proof-of-the-metropolis-et-al-algorithm">
<h2><span class="section-number">11.2. </span>Proof of the Metropolis et al. Algorithm<a class="headerlink" href="#proof-of-the-metropolis-et-al-algorithm" title="Link to this heading">#</a></h2>
<p>To prove that the algorithm does indeed generate a sequence of points distributed according to <span class="math notranslate nohighlight">\(w\)</span>, let us consider a large number of walkers, starting from different initial points and moving independently through <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> space.</p>
<p>If <span class="math notranslate nohighlight">\(N_n(\mathbf{X})\)</span> is the density of walkers at <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> after <span class="math notranslate nohighlight">\(n\)</span> steps, then the net number of walkers moving from point <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> to a point <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span> in the next step is:</p>
<p><span class="math notranslate nohighlight">\(\Delta N(\mathbf{X}) = N_n(\mathbf{X}) P(\mathbf{X} \rightarrow \mathbf{Y}) - N_n(\mathbf{Y}) P(\mathbf{Y} \rightarrow \mathbf{X})\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(P(\mathbf{X} \rightarrow \mathbf{Y})\)</span> is the probability that a walker will make a transition to <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span> if it is at <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>.</p>
<p>Taking out a common factor <span class="math notranslate nohighlight">\(N_n (\mathbf{Y}) P(\mathbf{X} \rightarrow \mathbf{Y})\)</span>:</p>
<p><span class="math notranslate nohighlight">\(\Delta N(\mathbf{X}) = N_n (\mathbf{Y}) P(\mathbf{X} \rightarrow \mathbf{Y}) \left[ \frac{ N_n(\mathbf{X})}{N_n (\mathbf{Y})} - \frac{P(\mathbf{Y} \rightarrow \mathbf{X})}{P(\mathbf{X} \rightarrow \mathbf{Y})}\right]\)</span>.</p>
<p>The above shows that there is equilibrium, corresponding to no net population change, when:</p>
<p><span class="math notranslate nohighlight">\(\frac{ N_n(\mathbf{X})}{N_n (\mathbf{Y})} = \frac{ N_e(\mathbf{X})}{N_e (\mathbf{Y})} \equiv \frac{P(\mathbf{Y} \rightarrow \mathbf{X})}{P(\mathbf{X} \rightarrow \mathbf{Y})}\)</span>,</p>
<p>and that changes in <span class="math notranslate nohighlight">\(N(\mathbf{X})\)</span> when the system is not in equilibrium tend to drive it toward equilibrium, i.e. <span class="math notranslate nohighlight">\(\Delta N(\mathbf{X}) &gt; 0\)</span> if there are “too many walkers” at <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>, or if <span class="math notranslate nohighlight">\(N_n(\mathbf{X})/N_n(\mathbf{Y})\)</span> is greater than its equilibrium value.</p>
<p>Hence it is possible, and it can be shown, that after a large number of steps, the population of the walkers will settle down to its equilibrium distribution <span class="math notranslate nohighlight">\(N_e\)</span>.</p>
<p>What remains to be shown is that the transition probabilities of the algorithm lead to an equilibrium distribution of walkers <span class="math notranslate nohighlight">\(N_e(\mathbf{X}) \sim w(\mathbf{X})\)</span>.</p>
<p>The probability of making a step from <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> to <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span> is:</p>
<p><span class="math notranslate nohighlight">\(P(\mathbf{X} \rightarrow \mathbf{Y}) = T(\mathbf{X} \rightarrow \mathbf{Y}) A (\mathbf{X} \rightarrow \mathbf{Y})\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(T\)</span> is the probability of making a trial step from <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> to <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span>, and <span class="math notranslate nohighlight">\(A\)</span> is the probability of accepting that step.</p>
<p>If <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span> can be reached from <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> in a single step (i.e. if it is within a cube of side <span class="math notranslate nohighlight">\(\delta\)</span>, centered about <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>), then:</p>
<p><span class="math notranslate nohighlight">\(T(\mathbf{X} \rightarrow \mathbf{Y}) = T(\mathbf{Y} \rightarrow \mathbf{X})\)</span>.</p>
<p>so that the equilibrium distribution of the random walkers satisfies:</p>
<p><span class="math notranslate nohighlight">\(\frac{ N_e(\mathbf{X})}{N_e (\mathbf{Y})} = \frac{A(\mathbf{Y} \rightarrow \mathbf{X})}{A(\mathbf{X} \rightarrow \mathbf{Y})}\)</span>.</p>
<p>Now, there are two scenarios for the ratio between <span class="math notranslate nohighlight">\(w\)</span>’s at <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span>:</p>
<p>if <span class="math notranslate nohighlight">\(w(\mathbf{X}) &gt; w(\mathbf{Y})\)</span>, then <span class="math notranslate nohighlight">\(A(\mathbf{Y} \rightarrow \mathbf{X}) = 1\)</span>, and:</p>
<p><span class="math notranslate nohighlight">\(A(\mathbf{X} \rightarrow \mathbf{Y}) = \frac{ w(\mathbf{Y}) } {w(\mathbf{X})}\)</span>,</p>
<p>while if <span class="math notranslate nohighlight">\(w(\mathbf{X}) &lt; w(\mathbf{Y})\)</span>, then <span class="math notranslate nohighlight">\(A(\mathbf{X} \rightarrow \mathbf{Y}) = 1\)</span></p>
<p><span class="math notranslate nohighlight">\(A(\mathbf{Y} \rightarrow \mathbf{X}) = \frac{ w(\mathbf{X}) } {w(\mathbf{Y})}\)</span>.</p>
<p>Hence, in either case, the equilibrium population of the walkers satisfies:</p>
<p><span class="math notranslate nohighlight">\(\frac{ N_e(\mathbf{X})}{N_e (\mathbf{Y})} = \frac{ w(\mathbf{X})}{w(\mathbf{Y})}\)</span>,</p>
<p>so that the walkers are indeed distributed with the correct distribution.</p>
</section>
<section id="applying-the-metropolis-et-al-algorithm">
<h2><span class="section-number">11.3. </span>Applying the Metropolis et al. Algorithm<a class="headerlink" href="#applying-the-metropolis-et-al-algorithm" title="Link to this heading">#</a></h2>
<p>An obvious question is, how do we choose the step size, <span class="math notranslate nohighlight">\(\delta\)</span>?</p>
<p>To answer this, suppose that <span class="math notranslate nohighlight">\(\mathbf{X}_n\)</span> is at a maximum of <span class="math notranslate nohighlight">\(w\)</span>, the most likely place for it to be. If <span class="math notranslate nohighlight">\(\delta\)</span> is large, then <span class="math notranslate nohighlight">\(w(\mathbf{X}_t)\)</span> will likely be very much smaller than <span class="math notranslate nohighlight">\(w(\mathbf{X}_n)\)</span>, and most trial steps will be rejected, leading to an inefficient sampling of <span class="math notranslate nohighlight">\(w\)</span>. If <span class="math notranslate nohighlight">\(\delta\)</span> is very small, most trial steps will be accepted, but the random walker will never move very far, and so also lead to a poor sampling of the distribution.</p>
<p>A good rule of thumb is that the size of the trial step should be chosen so that about half of the trial steps are accepted.</p>
<p>One bane of applying the algorithm to sample a distribution is that the points that make up the random walk <span class="math notranslate nohighlight">\(\mathbf{X}_0, \mathbf{X}_1, ...\)</span> are <em>not independent</em> of one another, simply from the way in which they are generated. That is, <span class="math notranslate nohighlight">\(\mathbf{X}_{n+1}\)</span> is likely to be in the neighborhood of <span class="math notranslate nohighlight">\(\mathbf{X}_n\)</span>. Thus, while the points might be distributed properly as the walk becomes very long, they are not statistically independent of one another.</p>
<p>This dictates that some care should be taken in using them to, e.g., calculate integrals.</p>
<p>For example, suppose we wish to calculate:</p>
<p><span class="math notranslate nohighlight">\(I = \int \mathrm{d} \mathbf{X} w(\mathbf{X}) f(\mathbf{X})\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(w(\mathbf{X})\)</span> is the normalized weight function.</p>
<p>e.g. in one dimension:</p>
<p><span class="math notranslate nohighlight">\(I = \int \mathrm{d} x w(x) f(x)\)</span>, and change variables to <span class="math notranslate nohighlight">\(y\)</span>, with <span class="math notranslate nohighlight">\(\mathrm{d}y/\mathrm{d}x = w(x)\)</span> to get <span class="math notranslate nohighlight">\(I = \int \mathrm{d} y f(x(y))\)</span>.</p>
<p>We would do this by averaging the values of <span class="math notranslate nohighlight">\(f\)</span> over the points of the random walk. However, the usual estimate of the variance is invalid, because the <span class="math notranslate nohighlight">\(f(\mathbf{X}_i)\)</span> are <em>not</em> statistically independent.</p>
<p>The level of statistical dependence can be quantified by calculating the auto-correlation function:</p>
<p><span class="math notranslate nohighlight">\(C(k) = \frac{ \left&lt; f_i f_{i+k} \right&gt; - \left&lt; f_i \right&gt;^2 } { \left&lt; f_i^2 \right&gt; - \left&lt; f_i \right&gt;^2 }\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(\left&lt;...\right&gt;\)</span> indicates average over the random walk, e.g.:</p>
<p><span class="math notranslate nohighlight">\(\left&lt; f_i f_{i+k} \right&gt; = \frac{1}{N-k} \sum_{i=1}^{N-k} f(\mathbf{X}_i) f(\mathbf{X}_{i+k})\)</span>.</p>
<p>The non-vanishing of <span class="math notranslate nohighlight">\(C\)</span> for <span class="math notranslate nohighlight">\(k\neq 0\)</span> means that the <span class="math notranslate nohighlight">\(f\)</span>’s are <em>not</em> independent.</p>
<p>What can be done in practice is to compute the integral and its variance using points along the random walk separated by a fixed interval, the interval being chosen so that there is effectively no correlation between the points used. An appropriate sampling interval can be estimated from the value of <span class="math notranslate nohighlight">\(k\)</span> for which becomes small, e.g., say <span class="math notranslate nohighlight">\(C\lesssim  0.1\)</span>.</p>
<p>Another issue in applying the algorithm is where to start the random walk, i.e. what to take as <span class="math notranslate nohighlight">\(\mathbf{X}_0\)</span>. In principle any location is suitable and the results will be independent of this choice, as the walker will “thermalize” after some number of steps. In practice, an appropriate starting point is a probable one, where <span class="math notranslate nohighlight">\(w\)</span> is large. Some number of thermalization steps then can be taken before actual sampling begins to remove any dependence on the starting point.</p>
</section>
<section id="example-11-1-the-metropolis-algorithm-for-one-dimensional-integration">
<h2><span class="section-number">11.4. </span>Example 11.1: The Metropolis Algorithm for One-dimensional Integration<a class="headerlink" href="#example-11-1-the-metropolis-algorithm-for-one-dimensional-integration" title="Link to this heading">#</a></h2>
<p>(a) Use the algorithm of Metropolis et al. to sample the normal distribution in one dimension:</p>
<p><span class="math notranslate nohighlight">\(w(x) = e^{-x^2/2}/\sqrt{2\pi}\)</span>.</p>
<p>For various step sizes, study the acceptance ratio (i.e. the fraction of trial steps accepted), the correlation function (and hence the appropriate sampling frequency), and the overall computational efficiency.</p>
<p>(b) Use the random variables you generate to calculate the integral:</p>
<p><span class="math notranslate nohighlight">\(I = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{+\infty} \mathrm{d}x x^2 e^{-x^2/2}\)</span>,</p>
<p>and estimate the uncertainty in your answer.</p>
</section>
<section id="quantum-monte-carlo">
<h2><span class="section-number">11.5. </span>Quantum Monte Carlo<a class="headerlink" href="#quantum-monte-carlo" title="Link to this heading">#</a></h2>
<p>The algorithm of Metropolis et al. can be combined with a variational method to yield estimates of atomic and molecular ground state energies via quantum mechanics. We will examine one approach that will allow us to calculate an upper bound for the ground state energies of the Helium atom and the Hydrogen molecule (<span class="math notranslate nohighlight">\(H_2\)</span>).</p>
<section id="the-model">
<h3><span class="section-number">11.5.1. </span>The Model<a class="headerlink" href="#the-model" title="Link to this heading">#</a></h3>
<p>The system we will consider consists of two protons and two electrons. The protons are considered to be fixed (this is known as the Born-Oppenheimer approximation), and separated by a distance <span class="math notranslate nohighlight">\(S\)</span>. For <span class="math notranslate nohighlight">\(S \neq 0\)</span>, this represents a model of the <span class="math notranslate nohighlight">\(H_2\)</span> molecule, whereas for <span class="math notranslate nohighlight">\(S=0\)</span>, we have a model of the Helium atom. The figure below shows the coordinates defined in the problem, with the position vectors <span class="math notranslate nohighlight">\(\mathbf{r}_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf{r}_2\)</span> of electrons 1 and 2 are not shown for the sake of clarity.</p>
<p><img alt="image info" src="../../_images/gsofh.png" /></p>
<p>The Schrödinger equation for the model can be separated into “nuclear” and “electronic” parts in the Born-Oppenheimer approximation.</p>
<p>The electronic part is given by:</p>
<p><span class="math notranslate nohighlight">\(\hat{H} \psi_e (r_1, r_2, S) = \left[ -\frac{\hbar^2}{2 m_e} (\nabla_1^2 + \nabla_2^2) + V(r_1, r_2) \right] \psi_e(r_1,r_2,S) = E_0 (S) \psi_e (r_1, r_2, S)\)</span>,</p>
<p>and the nuclear part:</p>
<p><span class="math notranslate nohighlight">\(\left[ \frac{\hbar^2}{2 m_p} \nabla_S^2 + \frac{e^2}{4\pi \epsilon_0 S} + E_0(S)\right] \psi_n (S) = \epsilon \psi_n(S)\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(E_0(S)\)</span> represents the electronic eigenvalue, <span class="math notranslate nohighlight">\(\epsilon\)</span> is the total energy of the system, <span class="math notranslate nohighlight">\(m_{e,p}\)</span> are the electron and proton masses respectively, and <span class="math notranslate nohighlight">\(\psi_{e,n}\)</span> are the electron and proton eigenfunctions, respectively, and <span class="math notranslate nohighlight">\(V(r_1, r_2)\)</span> is the electrostatic potential for the electrons.</p>
<p>Adopting “dimensionless atomic units”, i.e. setting <span class="math notranslate nohighlight">\(a_0 = \frac{\hbar^2} {m_e e^2} \rightarrow 1\)</span>, where <span class="math notranslate nohighlight">\(a_0\)</span> is the Bohr radius, lengths are effectively given in Bohr radii. The resulting unit of energy is sometimes referred to as a “Hartree”, where 1 Hartree corresponds to <span class="math notranslate nohighlight">\(\sim 27.192\)</span> eV.</p>
<p>In these units, the electrostatic potential for the electrons, <span class="math notranslate nohighlight">\(V(r_1, r_2)\)</span>, is given by:</p>
<p><span class="math notranslate nohighlight">\(V(r_1, r_2) = -\left[ \frac{1}{r_{1L}} + \frac{1}{r_{1R}} + \frac{1}{r_{2L}} + \frac{1}{r_{2R}} - \frac{1}{r_{12}}\right]\)</span>.</p>
<p>The potential governing the protons’ motion at a separation <span class="math notranslate nohighlight">\(S (\neq 0)\)</span>, <span class="math notranslate nohighlight">\(U(S)\)</span> is the sum of the inter-proton electrostatic repulsion and the eigenvalue <span class="math notranslate nohighlight">\(E_0(S)\)</span> of the two-electron Schrödinger equation:</p>
<p><span class="math notranslate nohighlight">\(U(S) = \frac{1}{S} + E_0 (S)\)</span>.</p>
<p>Our goal here isa to obtain <span class="math notranslate nohighlight">\(E_0(S)\)</span>, the electronic eigenvalue.</p>
</section>
<section id="variational-monte-carlo">
<h3><span class="section-number">11.5.2. </span>Variational Monte Carlo<a class="headerlink" href="#variational-monte-carlo" title="Link to this heading">#</a></h3>
<p>Consider a Hamiltonian, <span class="math notranslate nohighlight">\(\hat{H}\)</span>, for which we seek to estimate the ground state. The analytic variational method consists of constructing a “trial” wave function <span class="math notranslate nohighlight">\(\psi_a\)</span>, which is parameterized by one or more variational parameters, <span class="math notranslate nohighlight">\(a\)</span>. The expectation value of the energy is then calculated from:</p>
<p><span class="math notranslate nohighlight">\(\left&lt; E(a) \right&gt; = \frac{ \left&lt; \psi_a | \hat{H} | \psi_a\right&gt; } { \left&lt; \psi_a| \psi_a\right&gt; }\)</span>,</p>
<p>where the denominator is not necessary if the trial wave function is properly normalized.</p>
<p>The expectation value of the energy is then minimized with respect to the variational parameters, <span class="math notranslate nohighlight">\(a\)</span>. The minimum value of <span class="math notranslate nohighlight">\(\left&lt; E(a) \right&gt;\)</span> yields an upper bound to the ground state energy of the system.</p>
<p>The Variational Monte Carlo (VMC) method seeks to minimize the energy numerically. In realistic systems, a many-body wave function assumes large values in small parts of the configuration space, and hence using homogeneously distributed random points to sample it is not sufficient. The algorithm of Metropolis et al. can be used to sample the required distribution, using an ensemble of random walkers moving through configuration space.</p>
<p>The trial wave function, denoted by <span class="math notranslate nohighlight">\(\psi_T(\mathbf{x})\)</span>, is used to define the <em>local energy</em>:</p>
<p><span class="math notranslate nohighlight">\(E_L(\mathbf{x}) = \frac{ \hat{H} \psi_T } {\psi_T}\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is a multi-coordinate which represents the coordinates of all the particles in the system.</p>
<p>Using the above definition of the local energy, the expectation value of the energy can be written as:</p>
<p><span class="math notranslate nohighlight">\(\left&lt; E\right&gt; = \frac{ \int \mathrm{d} \mathbf{x} \psi^2_T(\mathbf{x}) E_L(\mathbf{x}) } { \int \mathrm{d} \mathbf{x} \psi^2_T(\mathbf{x})  }\)</span>.</p>
<p>The algorithm then consists of producing an initial random configuration of walkers that move around configuration space. The walker is moved within a distance <span class="math notranslate nohighlight">\(d\)</span> of about its initial position <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>, to a new position <span class="math notranslate nohighlight">\(\mathbf{x}'\)</span>. The trial step is accepted or rejected, according to the usual Metropolis algorithm, with the ratio given by:</p>
<p><span class="math notranslate nohighlight">\(\rho = \frac{  \psi^2_T(\mathbf{x}') } { \psi^2_T(\mathbf{x})}\)</span>.</p>
<p>The expectation value of the energy is calculated by averaging the <em>local energy</em> over the random walk, taking into account the correct sampling interval, and excluding the thermalization steps at the start.</p>
<p>The size of the trial step can be chosen so that the acceptance ratio is equal to about <span class="math notranslate nohighlight">\(0.5\)</span> for each value of the variational parameter.</p>
<p>As a preparation to the full treatment of the <span class="math notranslate nohighlight">\(He\)</span> atom and <span class="math notranslate nohighlight">\(H_2\)</span> molecule, we investigate the Hydrogen atom in the following example. Note that a problem arises when attempting to calculate the auto-correlation function, because the trial wave function suggested by the problem is <em>too</em> close to the actual wave function. By examining the auto-correlation function, one notices that as <span class="math notranslate nohighlight">\(a \rightarrow 1\)</span> (i.e. as the trial function approaches the actual wave function), then <span class="math notranslate nohighlight">\(C(k)\)</span> becomes indeterminate, since the variance becomes zero at <span class="math notranslate nohighlight">\(a=1\)</span>.</p>
</section>
<section id="example-11-2-variational-monte-carlo-for-the-hydrogen-atom">
<h3><span class="section-number">11.5.3. </span>Example 11.2 Variational Monte Carlo for the Hydrogen Atom<a class="headerlink" href="#example-11-2-variational-monte-carlo-for-the-hydrogen-atom" title="Link to this heading">#</a></h3>
<p>Use the Variational Monte Carlo Method to calculate the ground state of the Hydrogen atom.</p>
<p>The Hamiltonian (energy) operator is:</p>
<p><span class="math notranslate nohighlight">\(\hat{H} = -\frac{1}{2} \nabla^2 - \frac{1}{r}\)</span>.</p>
<p>Use a trial wave function of the form:</p>
<p><span class="math notranslate nohighlight">\(\psi_a(r) = e^{-ar}\)</span>.</p>
<p>Note that for <span class="math notranslate nohighlight">\(a=1\)</span>, the trial wave function becomes proportional to the exact ground state wave function.</p>
<p>The local energy for the H atom is:</p>
<p><span class="math notranslate nohighlight">\(E_L(r) = -\frac{1}{r} - \frac{1}{2} a \left( a - \frac{2}{r} \right)\)</span>.</p>
<p>Start with a set of <span class="math notranslate nohighlight">\(N_w = 60\)</span> walkers distributed at random in a cube of side <span class="math notranslate nohighlight">\(d=20\)</span>.</p>
<p>Each walker should attempt trial steps by adding a random vector <span class="math notranslate nohighlight">\(\Delta \mathbf{r}\)</span> to the initial position <span class="math notranslate nohighlight">\(\vec{r}\)</span>.</p>
<p>The trial step should be accepted or rejected according to the ratio:</p>
<p><span class="math notranslate nohighlight">\(\rho = \psi^2_a(\mathbf{r} + \Delta \mathbf{r}) / \psi^2_a (\mathbf{r})\)</span>.</p>
<p>The trial step can be varied from 0.5 to 1, adjusted to keep the acceptance ratio to <span class="math notranslate nohighlight">\(\sim 0.5\)</span> as we vary the parameter <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p>You may use a sampling interval of a length of <span class="math notranslate nohighlight">\(\sim 25\)</span>. The minimum is expected to occur at <span class="math notranslate nohighlight">\(a=1\)</span>, with an energy <span class="math notranslate nohighlight">\(E=0.5=13.6\)</span> eV, with zero variance!</p>
</section>
<section id="vmc-for-the-h-2-molecule-and-he-atom">
<h3><span class="section-number">11.5.4. </span>VMC for the H_2 Molecule and He Atom<a class="headerlink" href="#vmc-for-the-h-2-molecule-and-he-atom" title="Link to this heading">#</a></h3>
<p>The trial wave function suitable for the <span class="math notranslate nohighlight">\(H_2\)</span> problem is a special case of the Padé-Jastrow wave functions. It consists of a correlated product of molecular orbitals:</p>
<p><span class="math notranslate nohighlight">\(\Phi(\mathbf{r}_1, \mathbf{r}_2) = \phi(\mathbf{r}_1) \phi(\mathbf{r}_2) f(\mathbf{r}_{12})\)</span>,</p>
<p>where:</p>
<p><span class="math notranslate nohighlight">\(\phi(\mathbf{r}_i) = e^{-r_{iL}/c} + e^{-r_{iR}/c}\)</span>,</p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(f(\mathbf{r}_{12}) = \exp \left[ \frac{r_{12}}{b(1 + a r_{12})} \right]\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(a, b, c\)</span> are variational parameters, and the coordinates are defined in the figure describing the model.</p>
<p>Certain conditions are imposed on these parameters, called “cusp” conditions, which cancel the divergences in the Coulomb potential as <span class="math notranslate nohighlight">\(\mathbf{r}_{1L,R}, \mathbf{r}_{2L, R}, \mathbf{r}_{12} \rightarrow 0\)</span>.</p>
<p>To derive the cusp conditions, what needs to be considered for each vector separately is, e.g.:</p>
<p><span class="math notranslate nohighlight">\(\lim_{r_{1L} \rightarrow 0} \left[ - \frac{1}{2\phi(\mathbf{r}_1)} \nabla_1^2 \phi(\mathbf{r}_1) - \frac{1}{r_{1L}} \right] =\)</span> finite terms.</p>
<p>After performing the differentiation for the Laplacian, the variational parameters <span class="math notranslate nohighlight">\(b, c\)</span> are chosen so as to cancel the negative divergence of the Coulomb potential. This procedure yields:</p>
<p><span class="math notranslate nohighlight">\(b=2\)</span> and <span class="math notranslate nohighlight">\(c = \frac{1}{1+ e^{-S/c}}\)</span>, where <span class="math notranslate nohighlight">\(S\)</span> is the inter-proton distance.</p>
<p>The second equation is transcendental and can be solved, e.g. via the Newton-Raphson method, each time the inter-proton separation is varied.</p>
<p>The remaining parameter, <span class="math notranslate nohighlight">\(a\)</span> can be varied in order to obtain the minimum variational energy.</p>
<p>What remains is to calculate the local energy for the system:</p>
<p><span class="math notranslate nohighlight">\(E_L(\mathbf{r}_1, \mathbf{r}_2) = \frac{\hat{H}\Phi(\mathbf{r}_1, \mathbf{r}_2)}{\Phi(\mathbf{r}_1, \mathbf{r}_2)  } = \frac{1}{\Phi(\mathbf{r}_1, \mathbf{r}_2)} \left[ -\frac{\hbar^2}{2 m_e} (\nabla_1^2 + \nabla_2^2) + V(r_1, r_2) \right] \Phi(\mathbf{r}_1, \mathbf{r}_2)\)</span>.</p>
<p>The following identity can be employed:</p>
<p><span class="math notranslate nohighlight">\(\nabla_1^2 \left[ f(\mathbf{r}_{12}) \phi(\mathbf{r}_1) \right] =  \phi(\mathbf{r}_1) \nabla^2_1 f(\mathbf{r}_{12}) + 2 \left[ \nabla_1 f(\mathbf{r}_12)\right] \cdot \left[ \nabla_1 \phi(\mathbf{r}_1)\right] + f(\mathbf{r}_{12}) \nabla^2_1 \phi(\mathbf{r}_1)\)</span>.</p>
<p>The distances to the “left” (L) and “right” (R) proton, and the inter-electron distance can be written as:</p>
<p><span class="math notranslate nohighlight">\(r_{iL} = \sqrt{ x_i^2 + y_i^2 + (z_1 + \frac{1}{2} S)^2}\)</span>,</p>
<p><span class="math notranslate nohighlight">\(r_{iR} = \sqrt{ x_i^2 + y_i^2 + (z_1 - \frac{1}{2} S)^2}\)</span>,</p>
<p>for <span class="math notranslate nohighlight">\(i = 1,2\)</span>, and</p>
<p><span class="math notranslate nohighlight">\(r_{12} = \sqrt{ (x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2}\)</span>.</p>
<p>One finds that:</p>
<p><span class="math notranslate nohighlight">\(\nabla_i^2 \phi(\mathbf{r}_i) = -\frac{2}{c} \left[ \frac{e^{-r_{iL}/c}}{r_{iL}} + \frac{e^{-r_{iR}/c}}{r_{iR}} \right] + \frac{ \phi(\mathbf{r_i})}{c^2}\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\nabla_i^2 f(\mathbf{r}_{12}) = f(\mathbf{r}_{12}) \left[ \frac{1}{b^2 ( 1 + a r_{12} )^4} + \frac{2}{b(1+a r_{12})^3 r_{12}} \right]\)</span>,</p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(2 \left[ \nabla_1 f(\mathbf{r}_12)\right] \cdot \left[ \nabla_1 \phi(\mathbf{r}_1)\right] = \frac{2 (-1)^i f(\mathbf{r}_{12})}{bc(1 + ar_{12})^2 } \left[ \hat{\mathbf{r}}_{iL} \cdot \hat{\mathbf{r}}_{12} e^{-r_{iL}/c} +  \hat{\mathbf{r}}_{iR} \cdot \hat{\mathbf{r}}_{12} e^{-r_{iR/c}}\right]\)</span>,</p>
<p>for <span class="math notranslate nohighlight">\(i=1,2\)</span>, representing each electron.</p>
<p>Putting everything together, we obtain:</p>
<p><span class="math notranslate nohighlight">\(E_L(\mathbf{r}_1, \mathbf{r}_2) = V(\mathbf{r}_1, \mathbf{r}_2) + E_1 + E_2\)</span>, with:</p>
<p><span class="math notranslate nohighlight">\(E_i = -\frac{1}{2} \left[ \frac{1}{(1+ ar_{12})^3} + \frac{1}{c^2} + \frac{1}{4} \frac{1}{(1 + a r_{12})^4} - \frac{2}{c} \frac{ e^{r_{iL}/c}/r_{iL} + e^{r_{iR}/c}/r_{iR} } {e^{r_{iL}/c}+ e^{r_{iR}/c}} + \frac{(-1)^i}{c} \frac{1}{(1+a r_{12})^2} \frac{ e^{r_{iL}/c} \hat{\mathbf{r}}_{iL} \cdot \hat{\mathbf{r}}_{12} + e^{-r_{iR/c}}\hat{\mathbf{r}}_{iR} \cdot \hat{\mathbf{r}}_{12} }{e^{r_{iL}/c}+ e^{r_{iR}/c}} \right]\)</span>.</p>
<p>The Metropolis algorithm is applied in this case using a distribution of <em>six-dimensional</em> walkers, each representing the two electrons in the system. The minimum variational energy for the <span class="math notranslate nohighlight">\(H_2\)</span> molecule can be determined by varying the parameter <span class="math notranslate nohighlight">\(a\)</span> at each inter-proton separation <span class="math notranslate nohighlight">\(S\)</span>. Note that the potential energy curve for the protons in this case needs to take into account the protons’ electrostatic repulsion.</p>
<p>To determine the upper bound for the ground state of the Helium atom, the inter-proton distance should be set to zero and the variational parameter should be varied.</p>
</section>
<section id="example-11-3-variational-monte-carlo-for-the-helium-atom">
<h3><span class="section-number">11.5.5. </span>Example 11.3 Variational Monte Carlo for the Helium Atom<a class="headerlink" href="#example-11-3-variational-monte-carlo-for-the-helium-atom" title="Link to this heading">#</a></h3>
<p>Use the Variational Monte Carlo Method to calculate the ground state of the Helium atom (two protons in the nucleus).</p>
<p>Compare to the known value for the ground state energy of He: <span class="math notranslate nohighlight">\(\simeq 79.005\)</span> eV (<a class="reference external" href="https://www.nist.gov/pml/atomic-spectra-database">https://www.nist.gov/pml/atomic-spectra-database</a>)</p>
<p>You may use the local energy provided below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">EnergyLocal</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the local energy for a 6-dimensional position vector r and interproton distance S and variational parameter a&quot;&quot;&quot;</span>
    <span class="c1"># get the components:</span>
    <span class="n">r1x</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">r1y</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">r1z</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">r2x</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">r2y</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">r2z</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    
    <span class="c1"># the vector connecting the electrons</span>
    <span class="n">r12x</span> <span class="o">=</span> <span class="n">r1x</span> <span class="o">-</span> <span class="n">r2x</span>
    <span class="n">r12y</span> <span class="o">=</span> <span class="n">r1y</span> <span class="o">-</span> <span class="n">r2y</span>
    <span class="n">r12z</span> <span class="o">=</span> <span class="n">r1z</span> <span class="o">-</span> <span class="n">r2z</span>

    <span class="c1"># the unit vector connecting the electrons:</span>
    <span class="n">r12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r12x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">r12y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">r12z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">r12x</span> <span class="o">=</span> <span class="n">r12x</span> <span class="o">/</span> <span class="n">r12</span>
    <span class="n">r12y</span> <span class="o">=</span> <span class="n">r12y</span> <span class="o">/</span> <span class="n">r12</span>
    <span class="n">r12z</span> <span class="o">=</span> <span class="n">r12z</span> <span class="o">/</span> <span class="n">r12</span>

    <span class="c1"># get the unit vectors for proton L and R for electron 1</span>
    <span class="n">r1L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r1x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">r1y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1z</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">r1R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r1x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">r1y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1z</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">r1Lx</span> <span class="o">=</span> <span class="n">r1x</span> <span class="o">/</span> <span class="n">r1L</span>
    <span class="n">r1Ly</span> <span class="o">=</span> <span class="n">r1y</span> <span class="o">/</span> <span class="n">r1L</span>
    <span class="n">r1Lz</span> <span class="o">=</span> <span class="p">(</span><span class="n">r1z</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S</span><span class="p">))</span> <span class="o">/</span> <span class="n">r1L</span>
    <span class="n">r1Rx</span> <span class="o">=</span> <span class="n">r1x</span> <span class="o">/</span> <span class="n">r1R</span>
    <span class="n">r1Ry</span> <span class="o">=</span> <span class="n">r1y</span> <span class="o">/</span> <span class="n">r1R</span>
    <span class="n">r1Rz</span> <span class="o">=</span> <span class="p">(</span><span class="n">r1z</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S</span><span class="p">))</span> <span class="o">/</span> <span class="n">r1R</span>

    <span class="c1"># get the unit vectors for proton L and R for electron 2</span>
    <span class="n">r2L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r2x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">r2y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">r2z</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">r2R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r2x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">r2y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">r2z</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">r2Lx</span> <span class="o">=</span> <span class="n">r2x</span> <span class="o">/</span> <span class="n">r2L</span>
    <span class="n">r2Ly</span> <span class="o">=</span> <span class="n">r2y</span> <span class="o">/</span> <span class="n">r2L</span>
    <span class="n">r2Lz</span> <span class="o">=</span> <span class="p">(</span><span class="n">r2z</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S</span><span class="p">))</span> <span class="o">/</span> <span class="n">r2L</span>
    <span class="n">r2Rx</span> <span class="o">=</span> <span class="n">r2x</span> <span class="o">/</span> <span class="n">r2R</span><span class="p">;</span>
    <span class="n">r2Ry</span> <span class="o">=</span> <span class="n">r2y</span> <span class="o">/</span> <span class="n">r2R</span><span class="p">;</span>
    <span class="n">r2Rz</span> <span class="o">=</span> <span class="p">(</span><span class="n">r2z</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">S</span><span class="p">))</span> <span class="o">/</span> <span class="n">r2R</span><span class="p">;</span>
    <span class="c1"># get the dot product between the unit vectors from protons L and R to electron 1 and the unit vector connecting</span>
    <span class="c1"># electrons 1 and 2:</span>
    <span class="n">r1Lr12</span> <span class="o">=</span> <span class="n">r1Lx</span> <span class="o">*</span> <span class="n">r12x</span> <span class="o">+</span> <span class="n">r1Ly</span> <span class="o">*</span> <span class="n">r12y</span> <span class="o">+</span> <span class="n">r1Lz</span> <span class="o">*</span> <span class="n">r12z</span><span class="p">;</span>
    <span class="n">r1Rr12</span> <span class="o">=</span> <span class="n">r1Rx</span> <span class="o">*</span> <span class="n">r12x</span> <span class="o">+</span> <span class="n">r1Ry</span> <span class="o">*</span> <span class="n">r12y</span> <span class="o">+</span> <span class="n">r1Rz</span> <span class="o">*</span> <span class="n">r12z</span><span class="p">;</span>
    <span class="c1"># get the dot product between the unit vectors from protons L and R to electron 2 and the unit vector connecting</span>
    <span class="c1"># electrons 1 and 2:</span>
    <span class="n">r2Lr12</span> <span class="o">=</span> <span class="n">r2Lx</span> <span class="o">*</span> <span class="n">r12x</span> <span class="o">+</span> <span class="n">r2Ly</span> <span class="o">*</span> <span class="n">r12y</span> <span class="o">+</span> <span class="n">r2Lz</span> <span class="o">*</span> <span class="n">r12z</span><span class="p">;</span>
    <span class="n">r2Rr12</span> <span class="o">=</span> <span class="n">r2Rx</span> <span class="o">*</span> <span class="n">r12x</span> <span class="o">+</span> <span class="n">r2Ry</span> <span class="o">*</span> <span class="n">r12y</span> <span class="o">+</span> <span class="n">r2Rz</span> <span class="o">*</span> <span class="n">r12z</span><span class="p">;</span>

	<span class="c1">#get c by solving the transcendetal equation</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">NPsolve</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
	<span class="c1">#a is the variational param</span>
    <span class="n">E1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span> <span class="p">((</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">r12</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="n">r12</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">r12</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> 
		<span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r1L</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="n">r1L</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r1R</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="n">r1R</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r1L</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r1R</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="p">)</span>
		<span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">r12</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r1L</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">r1Lr12</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r1R</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">r1Rr12</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r1L</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r1R</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="p">))</span>

    
    <span class="n">E2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span> <span class="p">((</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">r12</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="n">r12</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">r12</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> 
		<span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r2L</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="n">r2L</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r2R</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="n">r2R</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r2L</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r2R</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="p">)</span>
     		<span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">r12</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r2L</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">r2Lr12</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r2R</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">r2Rr12</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r2L</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r2R</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="p">))</span>

    <span class="n">V</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">r1L</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">r1R</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">r2L</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">r2R</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">r12</span><span class="p">;</span>

    <span class="c1"># sum up and return</span>
    <span class="c1">#localE = V + E12 + E1 + E2</span>
    <span class="n">localE</span> <span class="o">=</span> <span class="n">V</span> <span class="o">+</span> <span class="n">E1</span> <span class="o">+</span> <span class="n">E2</span>
    <span class="k">return</span> <span class="n">localE</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-11-4-variational-monte-carlo-for-the-hydrogen-molecule">
<h3><span class="section-number">11.5.6. </span>Example 11.4: Variational Monte Carlo for the Hydrogen Molecule<a class="headerlink" href="#example-11-4-variational-monte-carlo-for-the-hydrogen-molecule" title="Link to this heading">#</a></h3>
<p>Use the Variational Monte Carlo Method to calculate the ground state of the Hydrogen molecule (<span class="math notranslate nohighlight">\(H_2\)</span>).</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapters/Chapter11"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Chapter10/Chapter10.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">10. </span>Partial Differential Equations</p>
      </div>
    </a>
    <a class="right-next"
       href="../Chapter13/Chapter13.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">12. </span>A Brief Introduction to Monte Carlo Event Generators in Particle Physics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-algorithm-of-metropolis-et-al">11.1. The Algorithm of Metropolis et al.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proof-of-the-metropolis-et-al-algorithm">11.2. Proof of the Metropolis et al. Algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-the-metropolis-et-al-algorithm">11.3. Applying the Metropolis et al. Algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-11-1-the-metropolis-algorithm-for-one-dimensional-integration">11.4. Example 11.1: The Metropolis Algorithm for One-dimensional Integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-monte-carlo">11.5. Quantum Monte Carlo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model">11.5.1. The Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variational-monte-carlo">11.5.2. Variational Monte Carlo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-11-2-variational-monte-carlo-for-the-hydrogen-atom">11.5.3. Example 11.2 Variational Monte Carlo for the Hydrogen Atom</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vmc-for-the-h-2-molecule-and-he-atom">11.5.4. VMC for the H_2 Molecule and He Atom</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-11-3-variational-monte-carlo-for-the-helium-atom">11.5.5. Example 11.3 Variational Monte Carlo for the Helium Atom</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-11-4-variational-monte-carlo-for-the-hydrogen-molecule">11.5.6. Example 11.4: Variational Monte Carlo for the Hydrogen Molecule</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andreas Papaefstathiou
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>